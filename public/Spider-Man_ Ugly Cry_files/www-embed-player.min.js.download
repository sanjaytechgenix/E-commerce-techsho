!function(){var e=document.getElementById("player"),t=document.getElementById("loop-btn"),o=document.getElementById("info-btn"),n=document.getElementById("context-close-btn"),d=document.getElementById("share-btn"),a=document.getElementById("share-close-btn"),s=document.getElementById("share-copy-btn"),r=document.getElementById("share-link"),c=document.getElementById("player-thumbnail-overlay"),l=(document.getElementById("player-action-bar"),document.getElementById("embed-actions")),u=document.getElementById("video"),m=document.getElementById("video-loader"),p=document.getElementById("play-button"),v=document.getElementById("mute-cover"),b=playerjs.HTML5Adapter(u),y=document.getElementById("vlip-info"),f=y.getAttribute("data-verified"),g={id:u.getAttribute("data-id"),creator:u.getAttribute("data-creator"),title:u.getAttribute("data-title"),from:u.getAttribute("data-from"),slug:u.getAttribute("data-slug")},h=!1,L=!1,E=!1,w=null,C=null,I=null,A=!1,k=!1,B=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),T=window.location!=window.parent.location?document.referrer:document.location.href;var N,V,x,O=(N=["vlipsy.com","vlipsy-staging-2692.nodechef.com","site.vlipsy","vlipsy-dev-2692.nodechef.com"],x=((V=T).indexOf("//")>-1?V.split("/")[2]:V.split("/")[0]).split(":")[0].split("?")[0],N.includes(x));function P(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}function R(e){e&&(document.body.classList.add("ready"),f&&y.classList.add("verified"))}function z(e){try{l.parentNode.removeChild(l);var o=document.getElementById("vlip-embed-contents");o.parentNode.removeChild(o)}catch(e){}e&&(t.parentNode.removeChild(t),v.parentNode.removeChild(v),u.setAttribute("controls",!0),u.removeEventListener("ended",S))}function M(){O&&C&&W(u.muted,u.currentTime,u.duration),u.muted=!u.muted,u.muted?(E=!1,document.body.classList.add("muted"),document.body.classList.add("hover")):(u.currentTime=0,E=!0,document.body.classList.remove("hover"),document.body.classList.remove("muted")),document.body.classList.add("badge"),setTimeout(function(){document.body.classList.remove("badge")},300)}function S(){var e;O&&(e=u.muted?"muted":"unmuted",C[e].time=u.duration,C[e].percentage=1,C[e].loops=C[e].loops+1),u.muted||A||(M(),v.classList.add("animate-muted-state"),setTimeout(function(){v.classList.add("zoom"),setTimeout(function(){v.classList.remove("animate-muted-state"),v.classList.remove("zoom")},500)},20)),u.play()}function U(e){var o;if(((A=!A)?t.classList.add("active"):t.classList.remove("active"),e)&&(!k&&(o={Client:"Embed Player","Vlip Name":g.from?g.from+":  "+g.title:g.title,"Vlip ID":g.id,"Vlip URL":"https://vlipsy.com/vlip/"+g.id,"Embedded On":T,Creator:g.creator},amplitude.getInstance().logEvent("Vlip Loop Activated",o),k=!0,B))){var n=A?"ON":"OFF";document.body.getElementsByClassName("loop-audio-text")[0].innerHTML="Audio Loop "+n,t.classList.add("show-label"),setTimeout(function(){t.classList.remove("show-label")},1800)}}function D(){document.body.classList.remove("play-required"),p.removeEventListener("click",D),0==u.readyState?(u.src="",u.src=u.getAttribute("data-url"),u.load()):(u.pause(),u.currentTime=0,M()),_()}O||/bot|google|baidu|bing|msn|duckduckgo|facebookexternalhit|facebot|teoma|slurp|prerender|yandex/i.test(navigator.userAgent)&&amplitude.getInstance().setOptOut(!0),"1"==P("preview")&&(O=!1,!0,document.body.classList.add("preview")),O&&(document.body.classList.add("site"),z(),"1"==P("thumb")&&(h=!0,document.body.classList.add("thumb"),o&&(o.parentNode.removeChild(o),o=null))),u.muted=!0,document.body.classList.add("loading"),"1"==P("sound")&&u.muted&&M(),I=setTimeout(function(){clearTimeout(I),I=null,m&&(m.parentNode.removeChild(m),m=null),u.removeEventListener("loadeddata",_),document.body.classList.add("play-required"),p.addEventListener("click",D)},8e3),u.addEventListener("loadeddata",_),u.addEventListener("ended",S),u.addEventListener("ended",function(){j.emit("ended")}),u.addEventListener("timeupdate",function(){j.emit("timeupdate",{seconds:u.currentTime,duration:u.duration})}),window.resize=R();var j=new playerjs.Receiver;function q(){r.focus(),r.setSelectionRange(0,r.value.length)}function F(e){q();try{H(document.execCommand("copy"))}catch(e){H(!1)}B&&document.activeElement!=document.body&&document.activeElement.blur()}function H(t){w||((w=document.createElement("div")).id="notice",e.appendChild(w),t||w.classList.add("fail"),w.classList.add("in"),setTimeout(function(){w.classList.add("out"),setTimeout(function(){e.removeChild(w),w=null},320)},3e3))}function W(e,t,o){var n=e?"muted":"unmuted";C[n].loops>0||(C[n].percentage=Math.round(t/o*100)/100,C[n].time=t)}if(b.ready(),j.on("play",function(){u.play(),!1,j.emit("play")}),j.on("pause",function(){u.pause(),!0,j.emit("pause")}),j.on("getDuration",function(e){e(u.duration)}),j.on("getVolume",function(e){e(100*u.volume)}),j.on("setVolume",function(e){u.volume=e/100}),j.on("getCurrentTime",function(e){e(u.currentTime)}),j.on("setCurrentTime",function(e){u.currentTime=e}),j.on("mute",function(){u.muted=!0}),j.on("unmute",function(){u.muted=!1}),j.on("getMuted",function(e){e(u.mute)}),j.on("getLoop",function(e){e(u.loop)}),j.on("setLoop",function(e){u.loop=e}),j.ready(),O&&window.addEventListener("unload",function e(){window.removeEventListener("unload",e),C&&W(u.muted,u.currentTime,u.duration);var t=new CustomEvent("VlipViewData",{detail:C});window.parent.document.dispatchEvent(t)}),"0"!=P("sharing")||O)O||(d.addEventListener("click",function(){u.muted||M(),document.body.classList.contains("share")?document.body.classList.remove("share"):(document.body.classList.add("share"),q())}),document.getElementById("share-buttons").addEventListener("click",function(e){if(e.target&&"A"==e.target.nodeName){var t,o,n,d=u.getAttribute("data-share-url"),i="https://vlipsy.com/vlip/"+u.getAttribute("data-slug"),a=e.target.getAttribute("data-type");switch(a){case"facebook":t="width=650,height=335,toolbar=0,menubar=0,location=0,status=0,scrollbars=0,resizable=1,left=0,top=0",o="http://www.facebook.com/sharer/sharer.php?u="+i,n="180400799051034";break;case"twitter":t="width=650,height=260,toolbar=0,menubar=0,location=0,status=0,scrollbars=0,resizable=1,left=0,top=0",o="http://twitter.com/share?url="+d+"&via=VlipsyApp",n="13374293";break;case"reddit":t="width=750,height=650,toolbar=0,menubar=0,location=0,status=0,scrollbars=1,resizable=1,left=0,top=0",o="http://www.reddit.com/submit?url="+i,n="";break;case"sms":var s=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream?"&":"?";return void(location.href="sms:"+s+"body="+encodeURIComponent(i));case"pinterest":t="width=750,height=550,toolbar=0,menubar=0,location=0,status=0,scrollbars=0,resizable=1,left=0,top=0",o="http://www.pinterest.com/pin/create/button/?url="+i+"&media="+c.getAttribute("data-preview")+"&is_video=true&description="+u.getAttribute("data-title")+" - Vlipsy.com",n="4882252939336365223";break;case"copy-link":return void F()}t&&o&&(window.open(o,n,t),O||(r=a,l={Client:"Embed Player","Vlip Name":g.from?g.from+":  "+g.title:g.title,"Vlip ID":g.id,"Vlip URL":"https://vlipsy.com/vlip/"+g.id,"Embedded On":T,Creator:g.creator,Platform:r},amplitude.getInstance().logEvent("Vlip Shared",l))),q()}var r,l}),r.addEventListener("click",q),s.addEventListener("click",F),a.addEventListener("click",function(){document.body.classList.remove("share"),document.body.classList.remove("embed")}));else{var $=document.getElementsByClassName("share-view");for(i=0;i<$.length;i++)$[i].parentNode.removeChild($[i]);d.parentNode.removeChild(d)}function _(){u.removeEventListener("loadeddata",_),clearTimeout(I),I=null,p.parentNode.removeChild(p),O?C={muted:{time:0,percentage:0,loops:0},unmuted:{time:0,percentage:0,loops:0}}:ga("send","event","Embed View",g.id,T),u.play().then(function(){}).catch(function(e){console.log(e)}),setTimeout(function(){var e,o;R(!0),u.paused&&B?(!0,z(!0)):(h||(e=v.getElementsByClassName("click-for-sound-text")[0],o=e.offsetWidth,e.setAttribute("style","width:"+o),setTimeout(function(){document.body.classList.add("collapse"),e.setAttribute("style","width:0px")},3e3)),v.addEventListener("click",function(){var e;R(!0),M(),L||O||(e={Client:"Embed Player","Vlip Name":g.from?g.from+":  "+g.title:g.title,"Vlip ID":g.id,"Vlip URL":"https://vlipsy.com/vlip/"+g.id,"Embedded On":T,Creator:g.creator},amplitude.getInstance().logEvent("Vlip Unmuted",e),L=!0)}),t.addEventListener("click",U)),m&&m.parentNode.removeChild(m)},300)}"1"==P("loop")&&U(),o&&(o.addEventListener("click",function(){u.muted||M(),document.body.classList.remove("share"),document.body.classList.contains("context")?document.body.classList.remove("context"):document.body.classList.add("context")}),n.addEventListener("click",function(){document.body.classList.remove("context")})),0==B?("1"==P("labels")&&y.parentNode.removeChild(y),document.addEventListener("mouseover",function(){E||document.body.classList.add("hover")},!1),document.addEventListener("mouseout",function(){E=!1,document.body.classList.remove("hover")},!1)):(document.body.classList.add("mobile"),y.parentNode.removeChild(y)),u.src=u.getAttribute("data-url"),u.load(),u.readyState>3&&_()}();